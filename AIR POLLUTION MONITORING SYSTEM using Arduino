//C++ Code:
//Code the Arduino:

#include <Ultrasonic.h>
#include <ESP8266WiFi.h>

// Wi-Fi credentials
const char* ssid = "YOUR_WIFI_SSID";
const char* password = "YOUR_WIFI_PASSWORD";

// Server details
const char* serverIP = "YOUR_SERVER_IP";
const int serverPort = 80;
const String serverPath = "/update_parking_status.php";

// Ultrasonic sensor pins
const int triggerPin1 = 2;
const int echoPin1 = 3;
const int triggerPin2 = 4;
const int echoPin2 = 5;

Ultrasonic ultrasonic1(triggerPin1, echoPin1);
Ultrasonic ultrasonic2(triggerPin2, echoPin2);

void setup() {
  Serial.begin(115200);
  WiFi.begin(ssid, password);

  while (WiFi.status() != WL_CONNECTED) {
    delay(1000);
    Serial.println("Connecting to WiFi...");
  }
  Serial.println("Connected to WiFi.");
}

void loop() {
  float distance1 = ultrasonic1.distanceInCM();
  float distance2 = ultrasonic2.distanceInCM();

  bool isOccupied1 = (distance1 < 50); // Adjust the threshold for occupancy detection
  bool isOccupied2 = (distance2 < 50);

  sendParkingStatus(isOccupied1, isOccupied2);

  delay(1000);
}

void sendParkingStatus(bool status1, bool status2) {
  WiFiClient client;
  if (client.connect(serverIP, serverPort)) {
    String data = "parking1=" + String(status1) + "&parking2=" + String(status2);
    client.print("POST " + serverPath + " HTTP/1.1\r\n");
    client.print("Host: " + String(serverIP) + "\r\n");
    client.print("Connection: close\r\n");
    client.print("Content-Type: application/x-www-form-urlencoded\r\n");
    client.print("Content-Length: ");
    client.print(data.length());
    client.print("\r\n\r\n");
    client.print(data);
    client.print("\r\n\r\n");
    delay(10);
  }
  client.stop();
}


//Server Create with php:

<?php
if (isset($_POST['parking1']) && isset($_POST['parking2'])) {
    $parking1 = $_POST['parking1'];
    $parking2 = $_POST['parking2'];

    // Here, you can update the status in a database or perform any desired actions.
    // For demonstration purposes, we'll just print the status.
    echo "Parking 1 status: " . ($parking1 == '1' ? 'Occupied' : 'Vacant') . "\n";
    echo "Parking 2 status: " . ($parking2 == '1' ? 'Occupied' : 'Vacant') . "\n";
}
?>
